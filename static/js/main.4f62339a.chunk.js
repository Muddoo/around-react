(this["webpackJsonparound-us"]=this["webpackJsonparound-us"]||[]).push([[0],{19:function(e,t,n){},21:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(1),o=n.n(c),r=n(11),i=n.n(r),s=(n(19),n(3)),u=n(10),l=n(2),b=n.p+"static/media/Vectorlogo.4e8e0a1d.svg";var d=function(e){return Object(a.jsx)("header",{className:"header",children:Object(a.jsx)("img",{draggable:"false",src:e.logo,alt:"logo",className:"logo"})})},j=Object(c.createContext)();var f=function(e){var t=e.card,n=e.onCardClick,o=e.onCardDelete,r=e.onCardLike,i=e.loading,s=e.onUnLoadedImage,u=Object(c.useContext)(j),l=u._id===t.owner._id,b=t.likes.some((function(e){return e._id===u._id}));return Object(a.jsxs)("div",{className:"card",children:[Object(a.jsx)("img",{src:t.link,draggable:"false",alt:t.name,className:"card__image",onClick:function(){return n(t)},onLoad:i,onError:function(){return s(t)}}),Object(a.jsxs)("div",{className:"card__details",children:[Object(a.jsx)("h2",{className:"card__text",children:t.name}),Object(a.jsx)("button",{className:"card__icon-heart ".concat(b&&"card__icon-heart_black animate"),type:"button","aria-label":"heart-button",title:"like",onClick:function(){return r(t)}}),Object(a.jsx)("span",{className:"card__likes",children:t.likes.length})]}),Object(a.jsx)("button",{className:"card__icon-delete",type:"button","aria-label":"trash-button",title:"delete",onClick:function(){return o(t)},hidden:!l})]})};var p=function(e){var t=e.cards,n=e.onEditAvatar,o=e.onEditProfile,r=e.onAddPlace,i=e.onCardClick,s=e.onCardDelete,u=e.onCardLike,b=e.onUnloadedAvatar,d=e.onUnLoadedImage,p=Object(c.useContext)(j),O=Object(c.useState)(),m=Object(l.a)(O,2),v=m[0],h=m[1],g=Object(c.useState)(!1),_=Object(l.a)(g,2),x=_[0],C=_[1],k=Object(c.useState)(0),y=Object(l.a)(k,2),N=y[0],S=y[1],E=p&&x&&!0;function T(){S(N+1)}return Object(c.useEffect)((function(){if(x)return h(p.avatar);v&&b({avatar:v})}),[x]),Object(a.jsxs)("main",{children:[Object(a.jsxs)("section",{className:"profile ".concat(E||"hidden"),children:[Object(a.jsx)("div",{className:"profile__wrapper",onClick:n,children:Object(a.jsx)("img",{src:null===p||void 0===p?void 0:p.avatar,draggable:"false",alt:"profile image",className:"profile__image",onLoad:function(){return C(!0)},onError:function(){return C(!1)}})}),Object(a.jsxs)("div",{className:"profile__info",children:[Object(a.jsx)("h1",{className:"profile__name",children:null===p||void 0===p?void 0:p.name}),Object(a.jsx)("p",{className:"profile__text",children:null===p||void 0===p?void 0:p.about}),Object(a.jsx)("button",{className:"profile__edit-button","aria-label":"edit-button",type:"button",onClick:o})]}),Object(a.jsx)("button",{className:"profile__add-button","aria-label":"close-button",type:"button",onClick:r})]}),Object(a.jsx)("section",{className:"cards ".concat((t.length<7?N===t.length:N>=7)||"hidden"),children:t.map((function(e,t){return Object(a.jsx)(f,{card:e,onCardClick:i,onCardDelete:s,onCardLike:u,loading:t<7?T:null,onUnLoadedImage:d},e._id)}))})]})};var O=function(){return Object(a.jsx)("footer",{className:"footer",children:Object(a.jsx)("p",{className:"footer__text",children:" \xa9 2020 Around The U.S."})})},m=n(4);var v=function(e){var t=e.type,n=e.placeholder,c=e.name,o=e.min,r=e.max,i=e.value,s=e.error,u=e.onChange;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("input",{type:t,className:"popup__field ".concat(s&&"popup__field_border_red"),placeholder:n,name:c,autoComplete:"off",spellCheck:"false",minLength:o,maxLength:r,value:i,onChange:u}),Object(a.jsx)("span",{className:"popup__error",children:s})]})};var h=function(e){var t=e.name,n=e.title,c=e.isOpen,o=e.onClose,r=e.submitText,i=e.inputs,s=e.submit,u=e.field,b=e.error,d=e.onChange,j=e.submitButtonState,f=e.refButton;return Object(a.jsx)("div",{className:"popup popup_".concat(t," ").concat(c&&"visible"),onClick:o,children:Object(a.jsxs)("form",{action:"#",className:"popup__form",name:t,noValidate:!0,children:[Object(a.jsx)("button",{className:"popup__close","aria-label":"close-button",type:"button"}),Object(a.jsx)("h3",{className:"popup__header",children:n}),i&&i.map((function(e,t){var n=Object(l.a)(e,5),c=n[0],o=n[1],r=n[2],i=n[3],s=n[4];return Object(a.jsx)(v,{type:c,placeholder:o,name:r,min:i,max:s,value:u[r]||"",error:b[r],onChange:d},t)})),Object(a.jsx)("button",{type:"submit",className:"popup__submit active ".concat(j&&"inactive"),"aria-label":"submit-button",onClick:s,ref:f,disabled:j,children:c&&r})]})})};var g=function(e){var t=e.isOpen,n=e.onClose,o=e.submit,r=Object(c.useState)({}),i=Object(l.a)(r,2),s=i[0],u=i[1],b=Object(c.useState)({}),d=Object(l.a)(b,2),j=d[0],f=d[1];return Object(c.useEffect)((function(){u({avatar:""}),f({})}),[t]),Object(a.jsx)(h,{title:"Change profile picture",name:"profile-photo",isOpen:t,onClose:n,inputs:[["url","Image link","avatar"]],submit:function(e){e.preventDefault(),e.target.textContent="Saving...",o(s)},submitText:"Save",submitButtonState:function(){var e=Object.values(s).every((function(e){return""!==e}));return Object.values(j).some((function(e){return""!==e}))||!e}(),field:s,error:j,onChange:function(e){u(Object(m.a)({},e.target.name,e.target.value.trim()&&e.target.value)),f(Object(m.a)({},e.target.name,e.target.validationMessage))}})};var _=function(e){var t=e.isOpen,n=e.onClose,o=e.submit,r=Object(c.useContext)(j),i=Object(c.useState)({}),u=Object(l.a)(i,2),b=u[0],d=u[1],f=Object(c.useState)({}),p=Object(l.a)(f,2),O=p[0],v=p[1];return Object(c.useEffect)((function(){d({name:null===r||void 0===r?void 0:r.name,about:null===r||void 0===r?void 0:r.about})}),[r]),Object(a.jsx)(h,{title:"Edit profile",name:"profile-info",isOpen:t,onClose:n,inputs:[["text","Name","name",2,40],["text","About me","about",2,200]],submit:function(e){e.preventDefault(),e.target.textContent="Saving...",o(b)},submitText:"Save",submitButtonState:function(){var e=Object.values(b).every((function(e){return""!==e}));return Object.values(O).some((function(e){return""!==e}))||!e}(),field:b,error:O,onChange:function(e){d(Object(s.a)(Object(s.a)({},b),{},Object(m.a)({},e.target.name,e.target.value.trim()&&e.target.value))),v(Object(s.a)(Object(s.a)({},O),{},Object(m.a)({},e.target.name,e.target.validationMessage)))}})};var x=function(e){var t=e.isOpen,n=e.onClose,o=e.submit,r=Object(c.useRef)();return Object(c.useEffect)((function(){return t&&r.current.focus()}),[t]),Object(a.jsx)(h,{title:"Are you sure?",name:"delete",isOpen:t,onClose:n,submitText:"Yes",submit:function(e){e.preventDefault(),e.target.textContent="Saving...",o()},refButton:r})};var C=function(e){var t=e.isOpen,n=e.onClose,o=e.submit,r=Object(c.useState)({}),i=Object(l.a)(r,2),u=i[0],b=i[1],d=Object(c.useState)({}),j=Object(l.a)(d,2),f=j[0],p=j[1];return Object(c.useEffect)((function(){b({name:"",link:""}),p({})}),[t]),Object(a.jsx)(h,{title:"New place",name:"card",isOpen:t,onClose:n,inputs:[["text","Title","name",2,30],["url","Image link","link"]],submit:function(e){e.preventDefault(),e.target.textContent="Saving...",o(u)},submitText:"Create",submitButtonState:function(){var e=Object.values(u).every((function(e){return""!==e}));return Object.values(f).some((function(e){return""!==e}))||!e}(),field:u,error:f,onChange:function(e){b(Object(s.a)(Object(s.a)({},u),{},Object(m.a)({},e.target.name,e.target.value.trim()&&e.target.value))),p(Object(s.a)(Object(s.a)({},f),{},Object(m.a)({},e.target.name,e.target.validationMessage)))}})};var k=function(e){var t=e.isOpen,n=e.card,c=e.onClose,o=e.onClick;return Object(a.jsx)("figure",{className:"popup popup_figure ".concat(t?"visible":null),onClick:c,children:Object(a.jsxs)("div",{className:"popup__container",children:[Object(a.jsx)("img",{src:n&&n.link,draggable:"false",alt:"popup image",className:"popup__image",onClick:o}),Object(a.jsx)("p",{className:"popup__caption",children:n.name}),Object(a.jsx)("button",{className:"popup__close popup__close_fig","aria-label":"close-button",type:"button",title:"close"})]})})},y=n(5),N=n.n(y),S=n(8),E=n(12),T=n(13),L=new(function(){function e(t){var n=t.baseUrl,a=t.options;Object(E.a)(this,e),this._baseUrl=n,this._options=a}return Object(T.a)(e,[{key:"queryCards",value:function(){var e=Object(S.a)(N.a.mark((function e(t){var n,a,c,o,r,i,u;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.query,a=void 0===n?"":n,c=t.method,o=void 0===c?"GET":c,r=t.body,i=void 0===r?null:r,this._options=Object(s.a)(Object(s.a)({},this._options),{},{method:o,body:i&&JSON.stringify(i)}),e.next=4,fetch("".concat(this._baseUrl,"/cards/").concat(a),this._options);case 4:return u=e.sent,e.abrupt("return",u.ok?u.json():Promise.reject("Error: ".concat(u.status," - ").concat(u.statusText," - ").concat(u.url)));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getUser",value:function(){var e=Object(S.a)(N.a.mark((function e(){var t;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this._baseUrl,"/users/me"),this._options);case 2:return t=e.sent,e.abrupt("return",t.ok?t.json():Promise.reject("Error: ".concat(t.status," - ").concat(t.statusText," - ").concat(t.url)));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateProfile",value:function(){var e=Object(S.a)(N.a.mark((function e(t){var n,a,c,o,r,i;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.avatar,a=void 0===n?"":n,c=t.method,o=void 0===c?"PATCH":c,r=t.body,this._options=Object(s.a)(Object(s.a)({},this._options),{},{method:o,body:JSON.stringify(r)}),e.next=4,fetch("".concat(this._baseUrl,"/users/me/").concat(a),this._options);case 4:return i=e.sent,e.abrupt("return",i.ok?i.json():Promise.reject("Error: ".concat(i.status," - ").concat(i.statusText," - ").concat(i.url)));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}())({baseUrl:"https://around.nomoreparties.co/v1/group-7",options:{headers:{authorization:"53ef19e5-74f0-45cf-b7f3-6d5e1b396f52","Content-Type":"application/json"}}});var P=function(){var e=Object(c.useState)(),t=Object(l.a)(e,2),n=t[0],o=t[1],r=Object(c.useState)([]),i=Object(l.a)(r,2),f=i[0],m=i[1],v=Object(c.useState)(!1),h=Object(l.a)(v,2),y=h[0],N=h[1],S=Object(c.useState)(!1),E=Object(l.a)(S,2),T=E[0],P=E[1],U=Object(c.useState)(!1),w=Object(l.a)(U,2),D=w[0],A=w[1],q=Object(c.useState)(!1),B=Object(l.a)(q,2),I=B[0],F=B[1],J=Object(c.useState)(!1),M=Object(l.a)(J,2),V=M[0],z=M[1],G=Object(c.useState)({}),H=Object(l.a)(G,2),R=H[0],Y=H[1];function K(e){L.updateProfile({avatar:"avatar",body:e}).then((function(e){return o(e)})).catch((function(e){return console.log(e)})).finally((function(){return W()}))}function Q(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=f.filter((function(t){return t._id!==e._id}));L.queryCards({query:e._id,method:"DELETE"}).then((function(){return m(t)})).catch((function(e){console.log(e),m(f)})).finally((function(){return W()}))}function W(){N(!1),P(!1),A(!1),F(!1),z(!1)}function X(e){(e.target.classList.contains("popup")||e.target.classList.contains("popup__close"))&&W()}return Object(c.useEffect)((function(){Promise.all([L.getUser(),L.queryCards({})]).then((function(e){var t=Object(l.a)(e,2),n=t[0],a=t[1];o(n),m(a)})).catch((function(e){return console.log(e)}))}),[]),Object(a.jsx)("div",{className:"page",children:Object(a.jsxs)(j.Provider,{value:n,children:[Object(a.jsx)(d,{logo:b}),Object(a.jsx)(p,{cards:f,onEditAvatar:function(){N(!0)},onEditProfile:function(){P(!0)},onAddPlace:function(){A(!0)},onCardClick:function(e){z(!0),Y(e)},onCardDelete:function(e){F(!0),Y(e)},onCardLike:function(e){var t=e.likes.some((function(e){return e._id===n._id}))?"DELETE":"PUT",a="DELETE"===t?e.likes.filter((function(e){return e._id!==n._id})):[].concat(Object(u.a)(e.likes),[{_id:n._id}]),c=f.map((function(t){return e._id===t._id?Object(s.a)(Object(s.a)({},t),{},{likes:a}):t}));m(c),L.queryCards({query:"likes/".concat(e._id),method:t}).catch((function(e){console.log(e),m(f)}))},onUnLoadedImage:function(e){Q(e)},onUnloadedAvatar:K}),Object(a.jsx)(O,{}),Object(a.jsx)(g,{isOpen:y,onClose:X,submit:K}),Object(a.jsx)(_,{isOpen:T,onClose:X,submit:function(e){L.updateProfile({body:e}).then((function(e){return o(e)})).catch((function(e){return console.log(e)})).finally((function(){return W()}))}}),Object(a.jsx)(C,{isOpen:D,onClose:X,submit:function(e){L.queryCards({method:"POST",body:e}).then((function(e){m([e].concat(Object(u.a)(f)))})).catch((function(e){return console.log(e)})).finally((function(){return W()}))}}),Object(a.jsx)(x,{isOpen:I,onClose:X,submit:Q}),Object(a.jsx)(k,{isOpen:V,card:R,onClose:X,onClick:function(){var e=f.indexOf(R)+1;e===f.length&&(e=0),Y(f[e])}})]})})},U=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,22)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,o=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),o(e),r(e)}))};i.a.render(Object(a.jsx)(o.a.StrictMode,{children:Object(a.jsx)(P,{})}),document.getElementById("root")),U()}},[[21,1,2]]]);
//# sourceMappingURL=main.4f62339a.chunk.js.map